<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Advanced Marks Calculator - Smart distribution of marks for MCQs, Short Questions, and Long Questions">
    <meta name="keywords" content="marks calculator, exam marks, MCQ marks, education tool">
    <meta property="og:title" content="Advanced Marks Calculator">
    <meta property="og:description" content="Smart marks distribution calculator for exams">
    <meta property="og:type" content="website">
    <link rel="icon" type="image/png" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0f172a">
    <title>Advanced Marks Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #6366f1;
            --secondary-color: #4f46e5;
            --success-color: #10b981;
            --background-color: #0f172a;
            --card-background: rgba(30, 41, 59, 0.95);
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: rgba(255, 255, 255, 0.1);
            --gradient-1: linear-gradient(135deg, #6366f1, #4f46e5);
            --gradient-2: linear-gradient(135deg, #10b981, #4f46e5);
            --gradient-3: linear-gradient(135deg, #f59e0b, #ef4444);
            --gradient-4: linear-gradient(135deg, #8b5cf6, #d946ef);
            --gradient-5: linear-gradient(135deg, #0ea5e9, #6366f1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(79, 70, 229, 0.15) 0%, transparent 50%);
            z-index: -1;
            animation: gradientShift 15s ease infinite;
        }

        @keyframes gradientShift {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .container {
            max-width: 1200px;
            width: 100%;
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 2rem;
            padding: 1.5rem;
            margin: 0 auto;
            align-items: start;
            min-height: calc(100vh - 2rem);
            position: relative;
        }

        .calculator-card {
            background: var(--card-background);
            padding: 1.8rem;
            border-radius: 1.2rem;
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 0 30px rgba(99, 102, 241, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            height: fit-content;
        }

        .calculator-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(
                circle at var(--x, 50%) var(--y, 50%),
                rgba(99, 102, 241, 0.1) 0%,
                transparent 50%
            );
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .calculator-card:hover::before {
            opacity: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            animation: fadeInDown 0.5s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header h1 {
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.2rem;
            margin-bottom: 1.5rem;
        }

        .input-group {
            position: relative;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.8rem;
            background: rgba(15, 23, 42, 0.6);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 
                0 0 0 3px rgba(99, 102, 241, 0.2),
                0 4px 8px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 500;
            transition: all 0.3s ease;
            transform-origin: left;
        }

        .input-group:focus-within label {
            color: var(--primary-color);
            transform: scale(1.05);
        }

        .choices-container {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .choices-container h3 {
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .choice-box {
            padding: 1rem;
            margin: 0.8rem 0;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(79, 70, 229, 0.1));
            border-radius: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(99, 102, 241, 0.2);
            position: relative;
        }

        .choice-box:hover {
            transform: translateX(5px);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba   (79, 70, 229, 0.2));
            border-color: rgba(99, 102, 241, 0.4);
        }

        .choice-box p {
            font-size: 0.95rem;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .choice-box .distribution-info {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .choice-box .marks-total {
            font-weight: 600;
            color: var(--primary-color);
            background: rgba(99, 102, 241, 0.1);
            padding: 0.2rem 0.6rem;
            border-radius: 0.4rem;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .btn {
            padding: 1rem 1.5rem;
            border: none;
            border-radius: 0.8rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: var(--gradient-1);
            color: white;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 12px rgba(99, 102, 241, 0.3),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.2) 50%,
                transparent 100%
            );
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 6px 20px rgba(99, 102, 241, 0.4),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
        }

        .btn:active {
            transform: translateY(1px) scale(0.98);
        }

        .btn-randomize {
            background: var(--gradient-2);
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: scale(0);
            animation: ripple 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        .success-pulse {
            animation: successPulse 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); }
            100% { transform: scale(1); }
        }

        .preview-panel {
            background: var(--card-background);
            padding: 1.8rem;
            border-radius: 1.2rem;
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 0 30px rgba(99, 102, 241, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            height: fit-content;
            position: sticky;
            top: 2rem;
            overflow: visible;
            display: block;
            transform: translateX(0);
            opacity: 1;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 320px;
            margin-left: auto;
            z-index: 10;
        }

        .preview-panel.show {
            display: block;
            transform: translateX(0);
            opacity: 1;
            animation: panelAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes panelAppear {
            0% {
                transform: translateX(20px);
                opacity: 0;
                filter: brightness(0.5);
            }
            100% {
                transform: translateX(0);
                opacity: 1;
                filter: brightness(1);
            }
        }

        .chart-container {
            position: relative;
            width: 100%;
            padding: 0.5rem 0;
            margin-bottom: 1.2rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(
                var(--gradient-1) var(--mcq-deg, 0deg),
                var(--gradient-2) var(--mcq-deg, 0deg) var(--short-deg, 0deg),
                var(--gradient-3) var(--short-deg, 0deg) 360deg
            );
            position: relative;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.3),
                0 0 0 4px rgba(255, 255, 255, 0.05);
            transform-origin: center;
        }

        .pie-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            background: radial-gradient(circle at center, 
                rgba(99, 102, 241, 0.2) 0%,
                rgba(79, 70, 229, 0.3) 50%,
                rgba(59, 130, 246, 0.2) 100%
            );
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            box-shadow: 
                inset 0 4px 20px rgba(0, 0, 0, 0.3),
                0 0 15px rgba(99, 102, 241, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            will-change: transform;
            backface-visibility: hidden;
        }

        .pie-center::after {
            content: '';
            position: absolute;
            inset: -2px;
            background: radial-gradient(circle at center,
                rgba(255, 255, 255, 0.1) 0%,
                transparent 70%
            );
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            mix-blend-mode: overlay;
        }

        .pie-center.animate {
            animation: glowPulse 1.5s ease-in-out;
        }

        .pie-center.animate::after {
            animation: fadeInOut 1.5s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .pie-center .total-number {
            font-family: 'Inter', sans-serif;
            font-size: 2em;
            font-weight: 700;
            background: linear-gradient(135deg, #fff, #e2e8f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            z-index: 2;
            transform: translateZ(0);
            backface-visibility: hidden;
        }

        .pie-center .total-label {
            font-family: 'Inter', sans-serif;
            font-size: 0.8em;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.8);
            margin-top: -5px;
            position: relative;
            z-index: 2;
            transform: translateZ(0);
            backface-visibility: hidden;
        }

        .long-question-parts {
            margin-top: 1.2rem;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .long-question-parts h3 {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            text-align: center;
            position: relative;
        }

        .long-question-parts h3::after {
            content: '';
            position: absolute;
            bottom: -0.5rem;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 2px;
            background: var(--gradient-1);
            border-radius: 2px;
        }

        .part-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-top: 0.75rem;
        }

        .part-box {
            background: rgba(15, 23, 42, 0.6);
            padding: 1rem;
            border-radius: 0.8rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .part-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .part-box h3 {
            font-size: 1rem;
            margin-bottom: 0.4rem;
            color: var(--text-primary);
        }

        .part-box .marks {
            font-size: 1.6rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .part-box p {
            color: var(--text-secondary);
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        .part-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                transparent 0%,
                rgba(255, 255, 255, 0.05) 50%,
                transparent 100%
            );
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .part-box:hover::before {
            opacity: 1;
        }

        .error-message {
            margin-top: 1.5rem;
            padding: 1.2rem;
            border-radius: 1rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            transform: translateY(20px);
            opacity: 0;
            animation: slideUp 0.3s ease forwards;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .error-message.error {
            background: linear-gradient(145deg, rgba(239, 68, 68, 0.1), rgba(245, 158, 11, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        @keyframes slideUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .click-effect {
            position: relative;
            overflow: hidden;
        }

        .click-effect::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1);
            animation: clickRipple 0.6s ease-out;
        }

        @keyframes clickRipple {
            0% {
                transform: scale(0);
                opacity: 0.5;
            }
            100% {
                transform: scale(40);
                opacity: 0;
            }
        }

        .validation-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.3rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .valid {
            background: var(--gradient-2);
            color: white;
        }

        .invalid {
            background: var(--gradient-3);
            color: white;
        }

        .preview-section h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid;
            background: var(--gradient-4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .preview-mcq {
            border-image: linear-gradient(to right, #6366f1, #4f46e5) 1;
        }

        .preview-short {
            border-image: linear-gradient(to right, #10b981, #4f46e5) 1;
        }

        .preview-long {
            border-image: linear-gradient(to right, #f59e0b, #ef4444) 1;
        }

        .question-box {
            background: rgba(15, 23, 42, 0.6);
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 0.6rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .question-box:hover {
            transform: translateX(10px);
            background: var(--gradient-5);
        }

        .part-box {
            background: rgba(15, 23, 42, 0.8);
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 0.6rem;
            border-left: 4px solid var(--primary-color);
        }

        .part-box h4 {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .marks-badge {
            position: absolute;
            top: -0.5rem;
            right: -0.5rem;
            background: var(--gradient-1);
            padding: 0.4rem 0.8rem;
            border-radius: 0.8rem;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .total-preview {
            margin-top: 2rem;
            padding: 1rem;
            background: var(--gradient-1);
            border-radius: 0.8rem;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            animation: glowPulse 2s infinite;
        }

        @keyframes glowPulse {
            0%, 100% {
                box-shadow: 
                    inset 0 4px 20px rgba(0, 0, 0, 0.3),
                    0 0 15px rgba(99, 102, 241, 0.4);
                background: radial-gradient(circle at center, 
                    rgba(99, 102, 241, 0.2) 0%,
                    rgba(79, 70, 229, 0.3) 50%,
                    rgba(59, 130, 246, 0.2) 100%
                );
                filter: brightness(1);
            }
            50% {
                box-shadow: 
                    inset 0 4px 25px rgba(0, 0, 0, 0.4),
                    0 0 35px rgba(99, 102, 241, 0.8);
                background: radial-gradient(circle at center, 
                    rgba(99, 102, 241, 0.4) 0%,
                    rgba(79, 70, 229, 0.5) 50%,
                    rgba(59, 130, 246, 0.4) 100%
                );
                filter: brightness(1.2);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin: 1.2rem 0;
            padding: 0.8rem;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 1rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-card {
            background: rgba(15, 23, 42, 0.6);
            padding: 0.8rem;
            border-radius: 0.8rem;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            min-height: 90px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .stat-card .stat-value {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 0.4rem;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-card .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 0.4rem;
        }

        .stat-card .choice-info {
            font-size: 0.7rem;
            color: var(--text-primary);
            margin-top: 0.2rem;
            padding: 0.25rem 0.5rem;
            background: rgba(99, 102, 241, 0.2);
            border-radius: 0.4rem;
            display: inline-block;
            white-space: nowrap;
        }

        .distribution-bar {
            height: 10px;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 5px;
            margin: 1.2rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .bar-segment {
            height: 100%;
            position: absolute;
            top: 0;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .bar-segment::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.15) 50%,
                transparent 100%
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { opacity: 0.2; }
            50% { opacity: 0.5; }
            100% { opacity: 0.2; }
        }

        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                padding: 1.5rem;
                gap: 1.5rem;
            }

            .preview-panel {
                position: relative;
                top: 0;
                width: 100%;
                min-width: 100%;
            }

            .pie-chart {
                width: 140px;
                height: 140px;
            }

            .pie-center {
                width: 95px;
                height: 95px;
            }

            .pie-center .total-number {
                font-size: 2.2rem;
            }

            .stats-grid {
                padding: 0.75rem;
                gap: 0.75rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 1rem;
                gap: 1rem;
            }

            .calculator-card,
            .preview-panel {
                padding: 1.5rem;
            }

            .pie-chart {
                width: 120px;
                height: 120px;
            }

            .pie-center {
                width: 85px;
                height: 85px;
            }

            .pie-center .total-number {
                font-size: 2rem;
                min-width: 60px;
            }

            .pie-center .total-label {
                font-size: 0.7rem;
                letter-spacing: 1px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-card:last-child {
                grid-column: span 2;
            }

            .input-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        @keyframes rotatePie {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .sticky-buttons {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--card-background);
            padding: 1rem;
            margin: 0 -1.8rem 1rem;
            border-bottom: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .short-question-group {
            position: relative;
        }

        .short-input-container {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .answer-select {
            flex: 1;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.8rem;
            background: rgba(15, 23, 42, 0.6);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }

        .answer-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 
                0 0 0 3px rgba(99, 102, 241, 0.2),
                0 4px 8px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .short-input-container input {
            width: 100px;
        }

        .adjustment-message {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-1);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: slideUpFade 0.3s ease-out;
            font-weight: 500;
        }

        @keyframes slideUpFade {
            from {
                transform: translate(-50%, 20px);
                opacity: 0;
            }
            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }

        .marks-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-left: 0.5rem;
        }

        .choice-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .choice-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background: rgba(15, 23, 42, 0.6);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .choice-btn.active {
            background: var(--gradient-1);
            border-color: transparent;
        }

        .choice-btn:hover {
            background: var(--gradient-1);
            transform: translateY(-2px);
        }

        .stat-card .marks-info {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.2rem;
        }

        .marks-label-circle {
            font-size: 0.6rem;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: -0.2rem;
        }

        .choice-info {
            background: var(--gradient-1);
            padding: 0.4rem 0.8rem;
            border-radius: 0.6rem;
            font-size: 0.85rem;
            color: white;
            margin-left: 0.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* PWA Install Prompt Styles */
        #installPrompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gradient-1);
            padding: 12px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            animation: slideUp 0.3s ease-out;
        }

        #installPrompt button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }

        #installPrompt button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        #installPrompt .close {
            background: transparent;
            padding: 4px;
            margin-left: auto;
        }

        @keyframes slideUp {
            from {
                transform: translate(-50%, 100%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }

        /* Offline Indicator */
        #offlineIndicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--gradient-3);
            padding: 8px 16px;
            border-radius: 8px;
            display: none;
            align-items: center;
            gap: 8px;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .valid-marks {
            font-size: 0.8em;
            color: var(--text-secondary);
            font-weight: normal;
            background: rgba(99, 102, 241, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 8px;
        }

        .input-group input:invalid {
            border-color: #ef4444;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body>
    <div id="installPrompt">
        <span>Install Advanced Marks Calculator</span>
        <button id="installButton">Install Now</button>
        <button class="close" onclick="closeInstallPrompt()">✕</button>
    </div>
    <div id="offlineIndicator">
        <span>You're offline</span>
    </div>
    
    <div class="container">
        <div class="calculator-card">
            <div class="header">
                <h1>Advanced Marks Calculator</h1>
                <p>Smart distribution with suggestions</p>
                <div class="button-group sticky-buttons">
                    <button class="btn" onclick="calculate()">Calculate</button>
                    <button class="btn btn-randomize" onclick="randomize()">Randomize</button>
                </div>
            </div>

            <div class="input-grid">
                <div class="input-group">
                    <label for="totalMarks">Total Marks <span class="valid-marks">(Valid: 25, 30, 35, 40, 45, 50)</span></label>
                    <input type="number" id="totalMarks" placeholder="Enter total marks" min="25" max="50" onchange="updateSuggestions()">
                </div>

                <div class="input-group">
                    <label for="mcqCount">Number of MCQs</label>
                    <input type="number" id="mcqCount" value="6" min="5" max="8">
                </div>

                <div class="input-group short-question-group">
                    <label for="shortCount">Short Questions <span class="marks-label">(2 marks each)</span></label>
                    <div class="short-input-container">
                        <input type="number" id="shortCount" value="8" min="0">
                        <div class="choice-info" id="choiceInfo">Choose 2 questions</div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="longCount">Long Questions</label>
                    <input type="number" id="longCount" value="1" min="1" max="1" disabled>
                </div>
            </div>

            <div class="choices-container" id="suggestions">
                <!-- Suggestions will be added here -->
            </div>

            <div class="result-section" id="result">
                <!-- Results will be displayed here -->
            </div>
        </div>

        <div class="preview-panel" id="previewPanel">
            <div class="marks-badge">
                <span id="totalMarksBadge">0</span> marks
            </div>
            <div class="chart-container">
                <div class="pie-chart" id="pieChart">
                    <div class="pie-center" id="totalDisplay">
                        <span class="total-number">30</span>
                        <span class="total-label">TOTAL</span>
                    </div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card stat-mcq">
                    <div class="stat-value" id="mcqValue">6</div>
                    <div class="stat-label">MCQs</div>
                </div>
                <div class="stat-card stat-short">
                    <div class="stat-value" id="shortValue">8</div>
                    <div class="stat-label">Short Questions</div>
                </div>
                <div class="stat-card stat-long">
                    <div class="stat-value">1</div>
                    <div class="stat-label">Long Question</div>
                </div>
            </div>

            <div class="long-question-parts">
                <h3>Long Question Distribution</h3>
                <div class="part-container">
                    <div class="part-box">
                        <h3>Part A</h3>
                        <div class="marks">4</div>
                        <p>Marks</p>
                    </div>
                    <div class="part-box">
                        <h3>Part B</h3>
                        <div class="marks">4</div>
                        <p>Marks</p>
                    </div>
                </div>
            </div>

            <div class="distribution-bar">
                <div class="bar-segment bar-mcq" id="mcqBar"></div>
                <div class="bar-segment bar-short" id="shortBar"></div>
                <div class="bar-segment bar-long" id="longBar"></div>
            </div>
        </div>

        <div class="error-message" id="errorMsg"></div>
    </div>

    <script>
        let history = [];

        function updateSuggestions() {
            const totalMarks = parseInt(document.getElementById('totalMarks').value) || 0;
            const roundedMarks = roundToValidMarks(totalMarks);
            const suggestionsDiv = document.getElementById('suggestions');
            let suggestions = '';

            // Update short question choices based on total marks
            const choiceInfo = document.getElementById('choiceInfo');
            if (roundedMarks <= 30) {
                choiceInfo.textContent = 'Choose 2 questions';
            } else {
                choiceInfo.textContent = 'Choose 3 questions';
            }

            if (roundedMarks >= 20) {
                const longMarks = 8;
                const remainingMarks = roundedMarks - longMarks;
                const baseShortQuestions = Math.floor(remainingMarks * 0.6 / 2); // 60% for short questions
                const baseMCQs = Math.min(8, Math.floor(remainingMarks * 0.4)); // 40% for MCQs
                const totalShortQuestions = baseShortQuestions + 2; // Add 2 extra for choice

                suggestions = `
                    <h3>Suggested Distributions (${roundedMarks} marks)</h3>
                    <div class="choice-box" onclick="applySuggestion(1, ${roundedMarks})">
                        <p>
                            <span>${baseMCQs} MCQ + ${totalShortQuestions} S/Q (choose ${roundedMarks <= 30 ? '2' : '3'}) + 1 L/Q</span>
                            <span class="marks-total">${roundedMarks}m</span>
                        </p>
                        <div class="distribution-info">
                            MCQ: ${baseMCQs}m • Short: ${baseShortQuestions * 2}m • Long: 8m
                        </div>
                    </div>
                    <div class="choice-box" onclick="applySuggestion(2, ${roundedMarks})">
                        <p>
                            <span>${baseMCQs - 1} MCQ + ${totalShortQuestions + 1} S/Q (choose ${roundedMarks <= 30 ? '2' : '3'}) + 1 L/Q</span>
                            <span class="marks-total">${roundedMarks}m</span>
                        </p>
                        <div class="distribution-info">
                            MCQ: ${baseMCQs - 1}m • Short: ${(baseShortQuestions + 1) * 2}m • Long: 8m
                        </div>
                    </div>
                    <div class="choice-box" onclick="applySuggestion(3, ${roundedMarks})">
                        <p>
                            <span>${baseMCQs + 1} MCQ + ${totalShortQuestions - 1} S/Q (choose ${roundedMarks <= 30 ? '2' : '3'}) + 1 L/Q</span>
                            <span class="marks-total">${roundedMarks}m</span>
                        </p>
                        <div class="distribution-info">
                            MCQ: ${baseMCQs + 1}m • Short: ${(baseShortQuestions - 1) * 2}m • Long: 8m
                        </div>
                    </div>
                `;
            }

            suggestionsDiv.innerHTML = suggestions;
            document.getElementById('totalMarks').value = roundedMarks;
            
            // Update marks badge
            const totalMarksBadge = document.getElementById('totalMarksBadge');
            if (totalMarksBadge) {
                animateNumber(totalMarksBadge, roundedMarks);
            }
        }

        function roundToValidMarks(marks) {
            const validMarks = [25, 30, 35, 40, 45, 50];
            
            // If marks is already a valid value, return it
            if (validMarks.includes(marks)) {
                return marks;
            }
            
            // Find the closest valid mark value
            let closestMark = validMarks.reduce((prev, curr) => {
                return Math.abs(curr - marks) < Math.abs(prev - marks) ? curr : prev;
            });

            // Show adjustment message
            showAdjustmentMessage(`Adjusted to standard mark value: ${closestMark}`);
            
            return closestMark;
        }

        function getChoiceCount(totalMarks) {
            if (totalMarks <= 25) {
                return 2; // For papers up to 25 marks, choose 2 questions
            } else if (totalMarks <= 35) {
                return 2; // For papers up to 35 marks, choose 2 questions
            } else {
                return 3; // For papers above 35 marks, choose 3 questions
            }
        }

        function applySuggestion(option, totalMarks) {
            const mcqInput = document.getElementById('mcqCount');
            const shortInput = document.getElementById('shortCount');
            const longMarks = 8;
            const remainingMarks = totalMarks - longMarks;
            const baseShortQuestions = Math.floor(remainingMarks * 0.6 / 2);
            const baseMCQs = Math.min(8, Math.floor(remainingMarks * 0.4));

            switch(option) {
                case 1:
                    mcqInput.value = baseMCQs;
                    shortInput.value = baseShortQuestions;
                    break;
                case 2:
                    mcqInput.value = baseMCQs - 1;
                    shortInput.value = baseShortQuestions + 1;
                    break;
                case 3:
                    mcqInput.value = baseMCQs + 1;
                    shortInput.value = baseShortQuestions - 1;
                    break;
            }

            calculate(true);
        }

        function randomize() {
            const totalMarks = parseInt(document.getElementById('totalMarks').value) || 0;
            const roundedMarks = Math.round(totalMarks / 5) * 5;
            
            if (roundedMarks < 20) {
                const errorMsg = document.getElementById('errorMsg');
                errorMsg.textContent = 'Total marks should be at least 20 for randomization.';
                errorMsg.classList.add('error');
                errorMsg.style.display = 'block';
                return;
            }

            const remainingMarks = roundedMarks - 8; // Subtract long question marks
            const mcqCount = Math.min(7, Math.floor(Math.random() * 3) + 5); // 5-7 MCQs
            const shortCount = Math.floor((remainingMarks - mcqCount) / 2);

            document.getElementById('mcqCount').value = mcqCount;
            document.getElementById('shortCount').value = shortCount;
            document.getElementById('totalMarks').value = roundedMarks;

            calculate(true);
        }

        function adjustMCQsToReachTarget(currentTotal, targetTotal) {
            const mcqInput = document.getElementById('mcqCount');
            const currentMCQs = parseInt(mcqInput.value);
            const difference = targetTotal - currentTotal;
            
            let newMCQCount = currentMCQs + difference;
            newMCQCount = Math.max(5, Math.min(8, newMCQCount));
            
            if (newMCQCount !== currentMCQs) {
                mcqInput.value = newMCQCount;
                showAdjustmentMessage(`Adjusted MCQs to ${newMCQCount} to reach ${targetTotal} marks`);
            }
            
            return newMCQCount;
        }

        function showAdjustmentMessage(message) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'adjustment-message';
            msgDiv.textContent = message;
            document.body.appendChild(msgDiv);
            
            // Show message with animation
            msgDiv.style.display = 'block';
            setTimeout(() => {
                msgDiv.style.opacity = '0';
                setTimeout(() => msgDiv.remove(), 300);
            }, 3000);
        }

        function calculate(isFromRandomize = false) {
            const mcqs = parseInt(document.getElementById('mcqCount').value);
            const shorts = parseInt(document.getElementById('shortCount').value);
            const mcqMarks = mcqs * 1;
            const shortMarks = shorts * 2;
            const longMarks = 8;
            let totalCalculated = mcqMarks + shortMarks + longMarks;
            
            // Round to valid marks if needed
            totalCalculated = roundToValidMarks(totalCalculated);
            
            // Adjust MCQs if needed to reach valid total
            if (!isFromRandomize) {
                const mcqInput = document.getElementById('mcqCount');
                const currentMCQs = parseInt(mcqInput.value);
                const difference = totalCalculated - (currentMCQs + shortMarks + longMarks);
                
                if (difference !== 0) {
                    const newMCQCount = currentMCQs + difference;
                    if (newMCQCount >= 5 && newMCQCount <= 8) {
                        mcqInput.value = newMCQCount;
                        showAdjustmentMessage(`Adjusted MCQs to ${newMCQCount} to reach ${totalCalculated} marks`);
                    }
                }
            }

            // Add animation to pie center
            const pieCenter = document.querySelector('.pie-center');
            pieCenter.classList.remove('animate');
            void pieCenter.offsetWidth; // Trigger reflow
            pieCenter.classList.add('animate');

            // Update displays with animation
            const totalDisplay = document.querySelector('.pie-center .total-number');
            const totalMarksBadge = document.getElementById('totalMarksBadge');
            
            if (totalDisplay) {
                animateNumber(totalDisplay, totalCalculated);
            }
            
            if (totalMarksBadge) {
                animateNumber(totalMarksBadge, totalCalculated);
                
                // Add a subtle pulse animation to the badge
                const marksBadge = totalMarksBadge.closest('.marks-badge');
                if (marksBadge) {
                    marksBadge.classList.remove('success-pulse');
                    void marksBadge.offsetWidth; // Trigger reflow
                    marksBadge.classList.add('success-pulse');
                }
            }
            
            // Update pie chart distribution
            const mcqPercent = (mcqMarks / totalCalculated) * 100;
            const shortPercent = (shortMarks / totalCalculated) * 100;
            const longPercent = (longMarks / totalCalculated) * 100;
            
            document.documentElement.style.setProperty('--mcq-deg', `${(mcqPercent / 100) * 360}deg`);
            document.documentElement.style.setProperty('--short-deg', `${((mcqPercent + shortPercent) / 100) * 360}deg`);
            
            // Update stat cards
            const mcqValue = document.getElementById('mcqValue');
            const shortValue = document.getElementById('shortValue');
            
            if (mcqValue) animateNumber(mcqValue, mcqs);
            if (shortValue) animateNumber(shortValue, shorts);
            
            // Update result section
            const result = document.getElementById('result');
            result.innerHTML = `
                <h3>Distribution Results:</h3>
                <p>MCQs: ${mcqs} × 1 = ${mcqMarks} marks (${Math.round(mcqMarks/totalCalculated*100)}%)</p>
                <p>Short Questions: ${shorts} × 2 = ${shortMarks} marks (${Math.round(shortMarks/totalCalculated*100)}%)</p>
                <p>Long Question: 1 × 8 = ${longMarks} marks (${Math.round(longMarks/totalCalculated*100)}%)</p>
                <p style="font-size: 1.2em; font-weight: bold; margin-top: 15px;">
                    Total Marks: ${totalCalculated}
                </p>
            `;
            result.style.display = 'block';

            // Add to history
            addToHistory({
                totalMarks: totalCalculated,
                mcqCount: mcqs,
                shortCount: shorts,
                timestamp: new Date().toLocaleTimeString()
            });
        }

        function animateNumber(element, finalNumber) {
            const startNumber = parseInt(element.textContent) || 0;
            const duration = 1000;
            const steps = 20;
            const stepDuration = duration / steps;
            const increment = (finalNumber - startNumber) / steps;
            let currentStep = 0;

            const animation = setInterval(() => {
                currentStep++;
                const currentNumber = Math.round(startNumber + (increment * currentStep));
                element.textContent = currentNumber;

                if (currentStep >= steps) {
                    clearInterval(animation);
                    element.textContent = finalNumber;
                }
            }, stepDuration);
        }

        function suggestValidDistribution(totalMarks) {
            const longMarks = 8;
            const remainingMarks = totalMarks - longMarks;
            
            // Calculate optimal MCQ count (20-25% of total)
            const optimalMcqCount = Math.round((totalMarks * 0.22) / 1);
            
            // Calculate short questions (remaining marks divided by 2)
            const optimalShortCount = Math.floor((remainingMarks - optimalMcqCount) / 2);
            
            const suggestionsDiv = document.getElementById('suggestions');
            suggestionsDiv.innerHTML = `
                <h3>Suggested Distribution</h3>
                <div class="choice-box" onclick="applyDistribution(${optimalMcqCount}, ${optimalShortCount})">
                    <p>Recommended: ${optimalMcqCount} MCQs, ${optimalShortCount} Short Questions</p>
                    <small>This will give a balanced distribution of marks</small>
                </div>
            `;
        }

        function applyDistribution(mcqCount, shortCount) {
            document.getElementById('mcqCount').value = mcqCount;
            document.getElementById('shortCount').value = shortCount;
            calculate();
        }

        function updateDistributionBar(mcqPercent, shortPercent, longPercent) {
            const mcqBar = document.getElementById('mcqBar');
            const shortBar = document.getElementById('shortBar');
            const longBar = document.getElementById('longBar');

            // Reset positions first
            mcqBar.style.width = '0%';
            shortBar.style.width = '0%';
            longBar.style.width = '0%';
            shortBar.style.left = '0%';

            // Force reflow
            void mcqBar.offsetWidth;

            // Animate with new values
            requestAnimationFrame(() => {
                mcqBar.style.width = `${mcqPercent}%`;
                shortBar.style.left = `${mcqPercent}%`;
                shortBar.style.width = `${shortPercent}%`;
                longBar.style.left = `${mcqPercent + shortPercent}%`;
                longBar.style.width = `${longPercent}%`;
            });

            // Add percentage labels
            mcqBar.setAttribute('data-percent', `${Math.round(mcqPercent)}%`);
            shortBar.setAttribute('data-percent', `${Math.round(shortPercent)}%`);
            longBar.setAttribute('data-percent', `${Math.round(longPercent)}%`);
        }

        function animateStatCards() {
            document.querySelectorAll('.stat-card').forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('success-pulse');
                    setTimeout(() => card.classList.remove('success-pulse'), 500);
                }, index * 150);
            });
        }

        function addToHistory(entry) {
            history.unshift(entry);
            if (history.length > 5) history.pop(); // Keep only last 5 entries
            updateHistoryPanel();
        }

        function updateHistoryPanel() {
            const historyDiv = document.getElementById('history');
            let html = '<h2>History</h2>';
            
            history.forEach((entry, index) => {
                html += `
                    <div class="history-item" onclick="loadHistory(${index})">
                        <p>Total: ${entry.totalMarks} marks</p>
                        <small>MCQs: ${entry.mcqCount}, Short: ${entry.shortCount}</small>
                        <small>${entry.timestamp}</small>
                    </div>
                `;
            });

            historyDiv.innerHTML = html;
        }

        function loadHistory(index) {
            const entry = history[index];
            document.getElementById('totalMarks').value = entry.totalMarks;
            document.getElementById('mcqCount').value = entry.mcqCount;
            document.getElementById('shortCount').value = entry.shortCount;
            calculate();
        }

        function updatePreview() {
            const mcqCount = parseInt(document.getElementById('mcqCount').value) || 0;
            const shortCount = parseInt(document.getElementById('shortCount').value) || 0;
            const mcqMarks = mcqCount * 1;
            const shortMarks = shortCount * 2;
            const longMarks = 8;
            const totalMarks = mcqMarks + shortMarks + longMarks;

            // Update summaries
            document.getElementById('mcqSummary').textContent = `${mcqCount} MCQs × 1 mark = ${mcqMarks} marks`;
            document.getElementById('shortSummary').textContent = `${shortCount} Questions × 2 marks = ${shortMarks} marks`;

            // Calculate percentages
            const mcqPercentage = Math.round((mcqMarks / totalMarks) * 100);
            const shortPercentage = Math.round((shortMarks / totalMarks) * 100);
            const longPercentage = Math.round((longMarks / totalMarks) * 100);

            // Update percentage displays
            document.getElementById('mcqPercentage').textContent = `${mcqPercentage}%`;
            document.getElementById('shortPercentage').textContent = `${shortPercentage}%`;
            document.getElementById('longPercentage').textContent = `${longPercentage}%`;

            // Update percentage bars
            document.getElementById('mcqBar').style.width = `${mcqPercentage}%`;
            document.getElementById('shortBar').style.width = `${shortPercentage}%`;
            document.getElementById('longBar').style.width = `${longPercentage}%`;

            // Update total
            document.getElementById('totalPreview').textContent = `Total Marks: ${totalMarks}`;

            // Validate distribution
            validateDistribution(totalMarks, mcqMarks, shortMarks, longMarks);

            // Add success animation
            document.querySelectorAll('.section-summary').forEach(section => {
                section.classList.add('success-pulse');
                setTimeout(() => section.classList.remove('success-pulse'), 500);
            });

            // Add click effect
            document.querySelectorAll('.click-effect').forEach(element => {
                element.addEventListener('click', () => addClickEffect(element));
            });
        }

        function validateDistribution(total, mcq, short, long) {
            const errorMsg = document.getElementById('errorMsg');
            const idealMcqPercent = 25;
            const idealShortPercent = 50;
            const idealLongPercent = 25;

            const mcqPercent = (mcq / total) * 100;
            const shortPercent = (short / total) * 100;
            const longPercent = (long / total) * 100;

            let message = '';

            if (mcqPercent < 15) {
                message = 'MCQ percentage is too low. Consider adding more MCQs.';
            } else if (mcqPercent > 35) {
                message = 'MCQ percentage is too high. Consider reducing MCQs.';
            } else if (shortPercent < 40) {
                message = 'Short questions percentage is too low. Add more short questions.';
            } else if (shortPercent > 60) {
                message = 'Short questions percentage is too high. Reduce short questions.';
            }

            if (message) {
                errorMsg.textContent = message;
                errorMsg.style.display = 'block';
            } else {
                errorMsg.style.display = 'none';
            }
        }

        // Add click effect function
        function addClickEffect(element) {
            element.classList.add('click-effect');
            setTimeout(() => element.classList.remove('click-effect'), 600);
        }

        function updateStatCardMarks(card, marksText) {
            let marksInfo = card.querySelector('.marks-info');
            if (!marksInfo) {
                marksInfo = document.createElement('div');
                marksInfo.className = 'marks-info';
                card.appendChild(marksInfo);
            }
            marksInfo.textContent = marksText;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateSuggestions();
            updatePreview();

            // Add input event listeners for real-time preview updates
            ['mcqCount', 'shortCount'].forEach(id => {
                document.getElementById(id).addEventListener('input', updatePreview);
            });

            // Add mouse move effect for calculator card
            const calculatorCard = document.querySelector('.calculator-card');
            calculatorCard.addEventListener('mousemove', (e) => {
                const rect = calculatorCard.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 100;
                const y = ((e.clientY - rect.top) / rect.height) * 100;
                calculatorCard.style.setProperty('--x', `${x}%`);
                calculatorCard.style.setProperty('--y', `${y}%`);
            });

            // Add input validation for total marks
            document.getElementById('totalMarks').addEventListener('input', function(e) {
                const value = parseInt(e.target.value) || 0;
                const validMarks = [25, 30, 35, 40, 45, 50];
                
                if (!validMarks.includes(value)) {
                    const closestMark = roundToValidMarks(value);
                    if (value !== closestMark) {
                        showAdjustmentMessage(`Rounding to nearest valid value: ${closestMark}`);
                        setTimeout(() => {
                            this.value = closestMark;
                            updateSuggestions();
                        }, 500);
                    }
                }
            });

            // Add click effects to buttons
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    const rect = this.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    const ripple = document.createElement('span');
                    ripple.style.left = `${x}px`;
                    ripple.style.top = `${y}px`;
                    ripple.classList.add('ripple');
                    
                    this.appendChild(ripple);
                    setTimeout(() => ripple.remove(), 600);
                });
            });

            // Add keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    calculate();
                } else if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                    const mcqInput = document.getElementById('mcqCount');
                    const shortInput = document.getElementById('shortCount');
                    const focused = document.activeElement;
                    
                    if (focused === mcqInput) {
                        if (e.key === 'ArrowRight') shortInput.focus();
                    } else if (focused === shortInput) {
                        if (e.key === 'ArrowLeft') mcqInput.focus();
                    }
                } else if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                    const input = document.activeElement;
                    if (input.type === 'number') {
                        const value = parseInt(input.value) || 0;
                        input.value = e.key === 'ArrowUp' ? value + 1 : Math.max(0, value - 1);
                        updatePreview();
                    }
                }
            });
        });
    </script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>
    <script>
        // PWA Installation
        let deferredPrompt;
        const installPrompt = document.getElementById('installPrompt');
        const installButton = document.getElementById('installButton');
        const offlineIndicator = document.getElementById('offlineIndicator');

        // Check if PWA is already installed
        if (window.matchMedia('(display-mode: standalone)').matches) {
            console.log('PWA is installed');
        }

        // Handle PWA installation
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.style.display = 'flex';
        });

        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response to install prompt: ${outcome}`);
            deferredPrompt = null;
            installPrompt.style.display = 'none';
        });

        function closeInstallPrompt() {
            installPrompt.style.display = 'none';
        }

        // Offline/Online Status
        window.addEventListener('online', () => {
            offlineIndicator.style.display = 'none';
        });

        window.addEventListener('offline', () => {
            offlineIndicator.style.display = 'flex';
        });

        // Handle keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'Enter') {
                document.querySelector('#calculateButton').click();
            }
        });

        // Add to desktop shortcut for Windows
        if (navigator.userAgent.includes('Windows')) {
            window.addEventListener('appinstalled', () => {
                console.log('PWA was installed');
            });
        }
    </script>
</body>
</html> 